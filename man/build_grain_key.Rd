% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/build_grain_key.R
\name{build_grain_key}
\alias{build_grain_key}
\title{Construct Grain–Age Key from Individual Biological Observations}
\usage{
build_grain_key(data_biological)
}
\arguments{
\item{data_biological}{A data frame with individual-level biological data, including:
\describe{
\item{operation_date}{Sampling date (format: YYYY-MM-DD)}
\item{edad}{Age of the individual (integer; typically 0–3)}
\item{ptot_g}{Total individual weight in grams (numeric)}
}}
}
\value{
A list with:
\describe{
\item{grain_key}{Proportion-at-age by grain class, year, and quarter}
\item{weight_key}{Mean weight-at-age by grain class, year, and quarter}
\item{long_data}{Merged long-format data frame with intermediate variables}
\item{data}{Processed input data}
\item{N_by_age}{Number of individuals by age}
\item{W_by_age}{Mean weight by age}
\item{grain_data}{Grain values and classes}
\item{pct_by_age}{Proportions at age}
\item{weighted_pct}{Weighted proportions}
\item{long_pct}{Long-format proportion data}
\item{long_weighted}{Long-format weighted proportion data}
\item{long_n}{Long-format number at age}
\item{long_weight}{Long-format mean weight at age}
\item{merged}{Merged long-format output}
}
}
\description{
Builds a grain–age key based on individual biological records, specifically total weight (in grams)
and age (in years). Samples are classified into commercial grain size classes (approximated by fish/kg),
and the function estimates the proportion-at-age and mean weight-at-age within each grain class, by year and quarter.
}
\details{
The method uses the inverse of the average weight to estimate the number of individuals per kilogram ("Grain"),
which is then assigned to predefined grain size classes. For each class, it computes:
\itemize{
\item Proportion of individuals per age group (\code{grain_key})
\item Mean individual weight per age group (\code{weight_key})
}
}
